---
title: ä½¿ç”¨ iflow-cli-action åœ¨ GitHub ä¸Ž Qwen3-Coderã€Kimi K2 ä¸€èµ·å¿«é€Ÿæå‡ä½ çš„ç”Ÿäº§åŠ›
comments: true
poster: https://gcore.jsdelivr.net/gh/yeshan333/jsDelivrCDN@main/iflow-cli-actions-demo-workflow-banner.jpg
banner: https://gcore.jsdelivr.net/gh/yeshan333/jsDelivrCDN@main/iflow-cli-actions-demo-workflow-banner.jpg
mathjax: true
mermaid: true
keywords: "iFLOW CLI, Claude Code Action, iflow-cli-action, Qwen3-Coder, Kimi K2, Productivity, DevOps"
description: "ä½¿ç”¨ iflow-cli-action åœ¨ GitHub ä¸Ž Qwen3-Coderã€Kimi K2 ä¸€èµ·å¿«é€Ÿæå‡ä½ çš„ç”Ÿäº§åŠ›"
music:
  enable: false
  server: netease
  type: song
  id: 26664345
abstract: Welcome to my blog, enter password to read.
message: Welcome to my blog, enter password to read.
date: 2025-08-16 22:04:15
updated:
tags:
  - GitHub Actions
  - AI Development
  - Automation
  - iFLOW CLI
  - Issue Management
  - Pull Request Review
  - Qwen3-Coder
  - Kimi K2
  - Productivity
  - DevOps
categories:
  - Technology
  - AI
  - GitHub
sticky:
cover: https://gcore.jsdelivr.net/gh/yeshan333/jsDelivrCDN@main/iflow-cli-actions-demo-workflow-banner.jpg
password:
---

é˜¿é‡Œ[å¿ƒæµ AI](https://iflow.cn/) å›¢é˜Ÿçš„ iFLOW CLI å·²ç»å‘å¸ƒäº†ä¸€æ®µæ—¶é—´äº†, å®ƒæ˜¯ä¸€ä¸ªåŸºäºŽç»ˆç«¯çš„å¼ºå¤§æ™ºèƒ½ä½“ Agent.ç›®å‰é€šè¿‡å®ƒå¯ä»¥å…è´¹çš„ä½¿ç”¨åˆ°ä¸­å›½å¼€å‘è€…ç ”å‘çš„é¡¶çº§å¤§æ¨¡åž‹, æ¯”å¦‚ Qwen3-Coderã€Kimi K2 ç­‰ã€‚

è¿™ç¯‡æ–‡ç« ç»™å‡ºäº†å¾ˆå¤šçš„å®žæˆ˜ä¾‹å­ -> [ã€Šèƒ½è‡ªåŠ¨ç¼–ç  + è°ƒè¯•ï¼ŸiFlow CLI å®žæˆ˜äº²æµ‹ï¼ã€‹](https://blog.csdn.net/iFlow_AI/article/details/150391659?spm=1001.2014.3001.5501),æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ iFLOW CLI å®žçŽ° RAG ç³»ç»Ÿã€ç”Ÿæˆæ—…æ¸¸è§„åˆ’ç­‰ç­‰ã€‚

æ®è¯´å¯¹æ ‡ Claude Code çš„ SubAgents èƒ½åŠ›ä¼šåœ¨ä¸‹ä¸€ä¸ªç‰ˆæœ¬å‘å¸ƒ, è¿˜æä¾›äº†åŸºäºŽ Qwen VL è§†è§‰å¤§æ¨¡åž‹çš„å¤šæ¨¡æ€å¤„ç†èƒ½åŠ›, å¹¶ä¸”åœ¨å¹¶è¡Œä»»åŠ¡æ‰§è¡Œä¸Šæœ‰ä¸“é—¨çš„ä¼˜åŒ–ã€‚IDE æ’ä»¶ä¹Ÿå³å°†å‘å¸ƒäº†~

ä¸çŸ¥é“ä½ æœ‰æ²¡æœ‰åœ¨ GitHub ä¸Šä½¿ç”¨è¿‡ [Claude Code Action](https://github.com/anthropics/claude-code-action),æˆ‘ä»¬å¯ä»¥ä½¿ç”¨å®ƒå¿«é€Ÿçš„å¤„ç† GitHub ä»“åº“çš„ issues, è®©å®ƒæ ¹æ®æŸä¸ª issue è‡ªåŠ¨ç¼–ç å¹¶åˆ›å»º pull requests.æˆ‘ä»¬åªéœ€è¦åœ¨ issue è¯„è®ºä¸­ `@claude` å³å¯è§¦å‘è‡ªåŠ¨ç¼–ç ä»»åŠ¡çš„æ‰§è¡Œã€‚

iFLOW CLI çŽ°åœ¨ä¹Ÿæœ‰ç±»ä¼¼çš„å·¥å…·äº† -> [iflow-cli-action](https://github.com/vibe-ideas/iflow-cli-action), æ„Ÿè°¢ claude-code-action å’Œ [Gemini CLI Action](https://github.com/google-github-actions/run-gemini-cli) çš„å·¥ä½œ, iflow-cli-action çš„å®žçŽ°å€Ÿé‰´äº†å®ƒä»¬çš„è®¾è®¡ã€‚

æŽ¥ä¸‹æ¥æˆ‘ä»¬çœ‹çœ‹å¦‚ä½•åˆ©ç”¨ iflow-cli-action åœ¨ GitHub åˆ©ç”¨ä¸­å›½å¼€å‘è€…ç ”å‘çš„é¡¶çº§å¤§æ¨¡åž‹ Qwen3-Code ä¸Ž Kimi K2 å¿«é€Ÿæå‡ä½ çš„ç”Ÿäº§åŠ›ã€‚

## å¿«é€Ÿä½¿ç”¨ iflow-cli-action

iflow-cli-action å¯¹ iFLOW CLI è¿›è¡Œäº†å°è£…, åŸºäºŽ GitHub Actions æä¾›çš„å¼ºå¤§è‡ªåŠ¨åŒ–ä»»åŠ¡ç¼–æŽ’èƒ½åŠ›, æˆ‘ä»¬åªéœ€è¦åœ¨ GitHub ä»£ç ä»“åº“åˆ›å»ºå¯¹åº”çš„å·¥ä½œæµæ–‡ä»¶, å³å¯å¿«é€Ÿä½¿ç”¨ä¸Š iFLOW CLI è¿›è¡Œè‡ªåŠ¨ç¼–ç å’Œé—®é¢˜ (issues) å¤„ç†ã€‚

> å¦‚æžœä½ è¿˜ä¸ç†Ÿæ‚‰ GitHub Actions, é‚£ä¹ˆæˆ‘æŽ¨èä½ å¿«é€Ÿé˜…è¯»ä¸‹ GitHub å®˜æ–¹çš„å¿«é€Ÿä¸Šæ‰‹æŒ‡å— [GitHub Actions å¿«é€Ÿå…¥é—¨ - å‡ åˆ†é’Ÿå†…ä½“éªŒ GitHub Actions çš„æ ¸å¿ƒåŠŸèƒ½ã€‚](https://docs.github.com/zh/actions/get-started/quickstart)

åœ¨è¿™é‡Œ, æˆ‘ä»¬ç›´æŽ¥ç»™å‡ºä¸€ä¸ªç¤ºä¾‹çš„å·¥ä½œæµç¼–æŽ’æ–‡ä»¶, å®ƒä¼šä½¿ç”¨ iflow-cli-action åŽ»åˆ›å»ºä¸€ä¸ª PPT å¹»ç¯ç‰‡é£Žæ ¼çš„æ–‡æ¡£ç½‘ç«™, å¹¶å‘å¸ƒå‡ºæ¥, å¦‚ä¸‹ï¼š

![demo](https://ospy.shan333.cn/blog/iflow-cli-action/iflow-action-usage-demo.gif)

{% folding "å·¥ä½œæµå®šä¹‰" %}
```yaml
name: Build and Deploy Homepage

on:
  # Run every day at 02:00 UTC
  schedule:
    - cron: '0 2 * * *'
  # Allow manual trigger
  workflow_dispatch:
  # Also run on pushes to main branch
  push:
    branches:
    paths:
      - 'README.md'
      - 'README_zh.md'

# Sets permissions of the GITHUB_TOKEN to allow deployment to GitHub Pages
permissions:
  contents: read
  pages: write

# Allow only one concurrent deployment, skipping runs queued between the run in-progress and latest queued.
concurrency:
  group: "pages"
  cancel-in-progress: false

jobs:
  build:
    runs-on: ubuntu-latest
    env:
      GITHUB_PAGES: true
    steps:
      - name: Checkout repository
        uses: actions/checkout@v4

      - name: Setup Pages
        uses: actions/configure-pages@v4

      - name: Create homepage directory
        run: mkdir -p _site

      - name: Generate homepage using iFlow CLI
        uses: vibe-ideas/iflow-cli-action@main
        with:
          prompt: |
            è¯·ä»…è¯»å–å½“å‰ä»“åº“çš„ README.md æ–‡ä»¶å†…å®¹ï¼ˆä¸è¦è¯»å–å…¶ä»–ä»»ä½•æ–‡ä»¶ï¼‰,å°†å…¶è½¬æ¢ä¸ºä¸€ä¸ªåŸºäºŽ Reveal.js çš„ç²¾ç¾Žå¹»ç¯ç‰‡é£Žæ ¼æ–‡æ¡£ç½‘ç«™å¹¶ä¿å­˜ä¸º _site/index.html.
            
            è¦æ±‚ï¼š
            
            1. ä½¿ç”¨ Reveal.js æ¡†æž¶æž„å»ºå¹»ç¯ç‰‡å±•ç¤º,å°† README å†…å®¹æŒ‰é€»è¾‘ç»“æž„æ‹†åˆ†ä¸ºå¤šä¸ªå¹»ç¯ç‰‡é¡µé¢ï¼›
            
            2. å¹»ç¯ç‰‡ç»“æž„è®¾è®¡ï¼š
               - é¦–é¡µå¹»ç¯ç‰‡ï¼šé¡¹ç›®æ ‡é¢˜ã€å‰¯æ ‡é¢˜ã€GitHub é“¾æŽ¥å’Œé¡¹ç›®ç®€ä»‹
               - åŠŸèƒ½ç‰¹æ€§å¹»ç¯ç‰‡ï¼šçªå‡ºå±•ç¤ºä¸»è¦åŠŸèƒ½å’Œç‰¹ç‚¹
               - å®‰è£…æŒ‡å—å¹»ç¯ç‰‡ï¼šåˆ†æ­¥éª¤å±•ç¤ºå®‰è£…è¿‡ç¨‹
               - ä½¿ç”¨ç¤ºä¾‹å¹»ç¯ç‰‡ï¼šå±•ç¤ºä»£ç ç¤ºä¾‹å’Œé…ç½®è¯´æ˜Ž
               - é«˜çº§åŠŸèƒ½å¹»ç¯ç‰‡ï¼šå±•ç¤ºè¿›é˜¶ç”¨æ³•å’Œæœ€ä½³å®žè·µ
               - ç»“å°¾å¹»ç¯ç‰‡ï¼šè‡´è°¢ã€è´¡çŒ®æŒ‡å—å’Œè”ç³»æ–¹å¼ï¼›
            
            3. ä½¿ç”¨çŽ°ä»£åŒ–çš„ Reveal.js ä¸»é¢˜å’Œé…ç½®ï¼š
               - å¯ç”¨æ°´å¹³å’Œåž‚ç›´å¯¼èˆª
               - é…ç½®å¹»ç¯ç‰‡è¿‡æ¸¡åŠ¨ç”»æ•ˆæžœï¼ˆå¦‚ slideã€fadeã€zoomï¼‰
               - æ·»åŠ è¿›åº¦æ¡å’Œå¹»ç¯ç‰‡è®¡æ•°å™¨
               - æ”¯æŒé”®ç›˜å¯¼èˆªå’Œè§¦æ‘¸æ‰‹åŠ¿
               - å¯ç”¨è‡ªåŠ¨æ’­æ”¾åŠŸèƒ½ï¼ˆå¯æš‚åœï¼‰
               - æ·»åŠ å¹»ç¯ç‰‡ç¼©ç•¥å›¾æ¦‚è§ˆï¼›
            
            4. è§†è§‰è®¾è®¡é‡‡ç”¨è¶…çŽ°å®žä¸»ä¹‰æ•°å­—æ‹¼è´´é£Žæ ¼ï¼š
               - ä½¿ç”¨é²œæ˜Žçš„è‰²å½©å¯¹æ¯”å’Œå‡ ä½•å›¾å½¢å…ƒç´ 
               - åˆ›å»ºå±‚æ¬¡ä¸°å¯Œçš„è§†è§‰æ•ˆæžœ,ç»“åˆæ–‡æœ¬å’Œå›¾å½¢å…ƒç´ 
               - è¿ç”¨ä¸è§„åˆ™å½¢çŠ¶ã€é€æ˜Žåº¦å’Œé‡å æ•ˆæžœåˆ›é€ æ·±åº¦æ„Ÿ
               - é‡‡ç”¨åŠ¨æ€èƒŒæ™¯å’ŒåŠ¨ç”»è¿‡æ¸¡å¢žå¼ºè§†è§‰å†²å‡»åŠ›
               - ä½¿ç”¨æŠ½è±¡å›¾å½¢å’Œæ•°å­—å…ƒç´ ä½œä¸ºè£…é¥°å…ƒç´ 
               - ç¡®ä¿æ•´ä½“è®¾è®¡å…·æœ‰è‰ºæœ¯æ„Ÿå’Œè§†è§‰å¸å¼•åŠ›ï¼›
            
            5. å­—ä½“å¤§å°å’Œå¸ƒå±€ä¼˜åŒ–ï¼ˆé‡è¦ï¼‰ï¼š
               - æ ‡é¢˜å­—ä½“å¤§å°ï¼šä¸»æ ‡é¢˜ä½¿ç”¨ 2.5em,å‰¯æ ‡é¢˜ä½¿ç”¨ 1.8em,èŠ‚æ ‡é¢˜ä½¿ç”¨ 1.5em
               - æ­£æ–‡å­—ä½“å¤§å°ï¼šä½¿ç”¨ 1.2em,ç¡®ä¿åœ¨æ‰€æœ‰è®¾å¤‡ä¸Šæ¸…æ™°å¯è¯»
               - ä»£ç å­—ä½“å¤§å°ï¼šä½¿ç”¨ 0.9em,é¿å…ä»£ç å—è¿‡å¤§å¯¼è‡´å¸ƒå±€é—®é¢˜
               - è¡Œé«˜è®¾ç½®ï¼šæ­£æ–‡ä½¿ç”¨ 1.6 å€è¡Œé«˜,æ ‡é¢˜ä½¿ç”¨ 1.4 å€è¡Œé«˜
               - å†…å®¹åŒºåŸŸè¾¹è·ï¼šä¸ºæ¯å¼ å¹»ç¯ç‰‡è®¾ç½®åˆé€‚çš„ paddingï¼ˆä¸Šä¸‹ 60px,å·¦å³ 40pxï¼‰
               - ç¡®ä¿æ–‡å­—ä¸ŽèƒŒæ™¯æœ‰è¶³å¤Ÿé—´è·,é¿å…é®æŒ¡å’Œé‡å 
               - é™åˆ¶æ¯å¼ å¹»ç¯ç‰‡çš„å†…å®¹é‡,é¿å…ä¿¡æ¯è¿‡è½½
               - ä¸ºé•¿ä»£ç å—å®žçŽ°åž‚ç›´æ»šåŠ¨,è€Œä¸æ˜¯ç¼©å°å­—ä½“ï¼›
               - å¢žåŠ å­—ä½“æ—è®¾ç½®ï¼šä½¿ç”¨ç³»ç»Ÿé»˜è®¤å­—ä½“æ—,ç¡®ä¿åœ¨å„ç§è®¾å¤‡ä¸Šéƒ½æœ‰è‰¯å¥½æ˜¾ç¤ºæ•ˆæžœ
               - ä¸ºä¸åŒå±å¹•å°ºå¯¸è®¾ç½®è‡ªé€‚åº”å­—ä½“å¤§å°,ç¡®ä¿ç§»åŠ¨ç«¯é˜…è¯»ä½“éªŒ
               - ä½¿ç”¨ç›¸å¯¹å•ä½ï¼ˆem, remï¼‰è€Œéžç»å¯¹å•ä½ï¼ˆpxï¼‰ä»¥é€‚åº”ç”¨æˆ·ç¼©æ”¾è®¾ç½®
               - æ·»åŠ æ–‡å­—é˜´å½±æˆ–èƒŒæ™¯è‰²å—ä»¥å¢žå¼ºæ–‡å­—å¯è¯»æ€§,ç‰¹åˆ«æ˜¯åœ¨å¤æ‚èƒŒæ™¯ä¸Š
               - ä¸¥æ ¼æŽ§åˆ¶æ¯è¡Œå­—ç¬¦æ•°,é¿å…è¿‡é•¿è¡Œå¯¼è‡´çš„é˜…è¯»å›°éš¾ï¼›
            
            6. ä»£ç å±•ç¤ºä¼˜åŒ–ï¼š
               - ä½¿ç”¨ Reveal.js çš„ä»£ç é«˜äº®æ’ä»¶
               - æ”¯æŒè¯­æ³•é«˜äº®ï¼ˆYAMLã€Bashã€Markdown ç­‰ï¼‰
               - æ·»åŠ è¡Œå·å’Œå¤åˆ¶æŒ‰é’®
               - ä»£ç å—ä½¿ç”¨åˆé€‚çš„æœ€å¤§é«˜åº¦ï¼ˆ60vhï¼‰å’Œæ»šåŠ¨æ¡
               - å®žçŽ°ä»£ç ç‰‡æ®µçš„åŠ¨ç”»å±•ç¤ºæ•ˆæžœï¼›
            
            7. äº¤äº’åŠŸèƒ½ï¼š
               - æ·»åŠ å¯¼èˆªèœå•å’Œç« èŠ‚è·³è½¬
               - å®žçŽ°å…¨å±æ¨¡å¼å’Œæ¼”è®²è€…æ¨¡å¼
               - æ”¯æŒ ESC é”®æ˜¾ç¤ºå¹»ç¯ç‰‡æ¦‚è§ˆ
               - æ·»åŠ åˆ†äº«å’Œå¯¼å‡ºåŠŸèƒ½ï¼›
            
            8. å“åº”å¼è®¾è®¡ï¼š
               - ç¡®ä¿åœ¨æ¡Œé¢ã€å¹³æ¿å’Œç§»åŠ¨è®¾å¤‡ä¸Šçš„è‰¯å¥½ä½“éªŒ
               - ç§»åŠ¨è®¾å¤‡ä¸Šé€‚å½“å‡å°å­—ä½“å¤§å°ä½†ä¿æŒå¯è¯»æ€§
               - é€‚é…ä¸åŒå±å¹•å°ºå¯¸çš„å­—ä½“å’Œå¸ƒå±€
               - ä¼˜åŒ–è§¦æ‘¸è®¾å¤‡çš„äº¤äº’ä½“éªŒï¼›
               - ä¸ºå°å±å¹•è®¾å¤‡è®¾ç½®ç‰¹æ®Šæ ·å¼,ç¡®ä¿æ–‡å­—ä¸è¢«æˆªæ–­æˆ–é‡å 
               - ä½¿ç”¨åª’ä½“æŸ¥è¯¢ä¼˜åŒ–ä¸åŒåˆ†è¾¨çŽ‡ä¸‹çš„æ˜¾ç¤ºæ•ˆæžœï¼›
            
            9. æŠ€æœ¯å®žçŽ°ï¼š
                - ä»Ž CDN å¼•å…¥æœ€æ–°ç‰ˆæœ¬çš„ Reveal.js
                - é…ç½®å¿…è¦çš„æ’ä»¶ï¼ˆhighlight.jsã€notesã€zoom ç­‰ï¼‰
                - æ·»åŠ è‡ªå®šä¹‰ CSS æ ·å¼å¢žå¼ºè§†è§‰æ•ˆæžœ
                - ç¡®ä¿å¿«é€ŸåŠ è½½å’Œæµç•…çš„åŠ¨ç”»æ€§èƒ½ï¼›
                - ä½¿ç”¨ CSS çš„ word-wrapã€word-break å±žæ€§å¤„ç†é•¿å•è¯å’Œ URL æ¢è¡Œ
                - è®¾ç½®åˆç†çš„ z-index å±‚çº§,ç¡®ä¿æ–‡å­—å§‹ç»ˆåœ¨è£…é¥°å…ƒç´ ä¹‹ä¸Šï¼›
            
            10. SEO å’Œå¯è®¿é—®æ€§ï¼š
                - æ·»åŠ å®Œæ•´çš„ meta æ ‡ç­¾å’Œç»“æž„åŒ–æ•°æ®
                - ç¡®ä¿é”®ç›˜å¯¼èˆªçš„å¯è®¿é—®æ€§
                - æ·»åŠ  alt æ–‡æœ¬å’Œ aria æ ‡ç­¾
                - ä¼˜åŒ–æœç´¢å¼•æ“Žç´¢å¼•.
            
            è¯·ç›´æŽ¥åˆ›å»ºå®Œæ•´çš„ HTML æ–‡ä»¶,ä½¿ç”¨å†…è” CSS å’Œ JavaScript,ç¡®ä¿æ–‡ä»¶è‡ªåŒ…å«ä¸”å¯ä»¥ç›´æŽ¥åœ¨æµè§ˆå™¨ä¸­è¿è¡Œ.
            
            é¡¹ç›®åœ°å€ä¸ºï¼šhttps://github.com/vibe-ideas/iflow-cli-action
          api_key: ${{ secrets.IFLOW_API_KEY }}
          # settings_json: ${{ secrets.IFLOW_SETTINGS_JSON }}
          model: "Qwen3-Coder"
          timeout: "1800"
          extra_args: "--debug"

      - name: Verify reveal.js presentation was generated
        run: |
          if [ -f "_site/index.html" ]; then
            echo "Reveal.js presentation generated successfully!"
            echo "Checking for reveal.js content..."
            if grep -q "reveal.js" "_site/index.html"; then
              echo "âœ“ Reveal.js framework detected"
            else
              echo "âš  Warning: Reveal.js framework not found in generated file"
            fi
            ls -la _site/
          else
            echo "Error: Presentation was not generated by iFlow"
            exit 1
          fi

      - name: Upload artifact
        uses: actions/upload-pages-artifact@v3
        with:
          path: ./_site

  deploy:
    environment:
      name: github-pages
      url: ${{ steps.deployment.outputs.page_url }}
    runs-on: ubuntu-latest
    needs: build
    steps:
      - name: Deploy to GitHub Pages
        id: deployment
        uses: actions/deploy-pages@v4
```
{% endfolding %}

è¿™ä¸ªå·¥ä½œæµçš„æ‰§è¡Œæœºåˆ¶å¦‚ä¸‹ï¼š

![iflow-action-usage-demo.svg](https://gcore.jsdelivr.net/gh/yeshan333/jsDelivrCDN@main/iflow-action-usage-demo.svg)

å®ƒä¼šç›‘å¬ä»£ç ä»“åº“çš„ push äº‹ä»¶, æŸ¥çœ‹ README.md æ–‡ä»¶æ˜¯å¦å‘ç”Ÿå˜åŒ–, å¦‚æžœå‘ç”Ÿå˜åŒ–åˆ™è®© iFLOW CLI åˆ©ç”¨ Qwen3-COder æ¨¡åž‹, åŸºäºŽ Reveal.js æŠ€æœ¯ç”Ÿæˆå¹»ç¯ç‰‡, å¹¶éƒ¨ç½²åˆ° GitHub Pages.ä½ å¯ä»¥é€šè¿‡è¿™ä¸ªç½‘ç«™ç›´æŽ¥æŸ¥é˜…åˆ°å¯¹åº”çš„æ•ˆæžœ [https://vibe-ideas.github.io/iflow-cli-action/#/](https://vibe-ideas.github.io/iflow-cli-action/#/).

è‡ªåŠ¨åŒ–å·¥ä½œæµä½¿ç”¨åˆ°çš„ IFLOW_API_KEY å¯†é’¥éœ€è¦åˆ°å¿ƒæµå®˜æ–¹èŽ·å– [https://iflow.cn/?open=setting](https://iflow.cn/?open=setting).æˆ‘ä»¬éœ€è¦å°†å¯†é’¥ä¿å­˜åˆ° GitHub ä»“åº“çš„ Secrets ä¸­, é¿å…å¯†é’¥æ³„éœ².Settings -> Secrets and variables -> Actions -> New repository secret, Secrets åä¸º `IFLOW_API_KEY`:

ä½ å¯ä»¥å°†ä¸Šè¿°å·¥ä½œæµæ–‡ä»¶æ”¾åˆ°ä½ çš„ GitHub ä»£ç ä»“åº“çš„ `.github/workflows` ç›®å½•ä¸‹, æäº¤å¹¶æŽ¨é€åˆ° GitHub ä»“åº“å³å¯å¿«é€Ÿä½¿ç”¨ & æ‰§è¡Œã€‚

> ä½¿ç”¨æ—¶, è¯·ç¡®ä¿ä½ çš„ä»£ç ä»“åº“å­˜åœ¨ README.md æ–‡ä»¶ã€‚

æ›´å…·ä½“çš„ä½¿ç”¨æ–¹å¼, å¯ä»¥å‚è€ƒæˆ‘ä¸€å‘¨å‰å‘å¸ƒçš„æ–‡ç«  [ã€Šä½¿ç”¨ iFLOW-CLI GitHub Action å’Œ Qwen3-Coder ç»™ GitHub ä»“åº“ç”Ÿæˆå¹»ç¯ç‰‡é£Žæ ¼çš„æ–‡æ¡£ç«™ç‚¹ã€‹](https://shan333.cn/2025/08/09/gen-slides-like-docs-site-with-iflow-cli/).

æŽ¥ä¸‹æ¥æˆ‘ä»¬å°†ç€é‡ä»‹ç»å¦‚ä½•ä½¿ç”¨ iflow-cli-action è®© iFLOW CLI å¸®æˆ‘ä»¬è§£å†³ GitHub ä»£ç ä»“åº“ issuesã€å¯¹ pull request è¿›è¡Œä»£ç è¯„å®¡ã€‚è®© iFLOW CLI å˜èº«ä¸º issue æ€æ‰‹ã€‚

## è®© iFLOW CLI è‡ªåŠ¨åˆ†ç±» GitHub issues

å¦‚æžœä½ æ˜¯ä¸€ä¸ªå¼€æºé¡¹ç›®çš„å¼€å‘è€…æˆ–è€…è´¡çŒ®è€…, ç›¸ä¿¡å¯¹äºŽ GitHub issues çš„åˆ†ç±»æ‰“æ ‡ç­¾ (label) å¹¶ä¸é™Œç”Ÿ, è¿™é‡Œæˆ‘ä»¬ç»™å‡ºä¸€ä¸ªç¤ºä¾‹å·¥ä½œæµ, å®ƒå¯ä»¥å®žçŽ°, å½“æœ‰ç”¨æˆ·åœ¨ä»£ç ä»“åº“åˆ›å»ºæ–°çš„ issue æ—¶, ä¼šè‡ªåŠ¨è¿è¡Œ, ä½¿ç”¨ iFLOW CLI å’Œ Qwen3-COder æ¨¡åž‹åˆ†æž issue å†…å®¹, ç„¶åŽç»™ issue æ‰“ä¸Šå¯¹åº”çš„åˆ†ç±»æ ‡ç­¾, æ–¹ä¾¿å¼€å‘è€…å¯¹ issues è¿›è¡Œç®¡ç†, å¦‚ä¸‹ï¼š

```yaml
name: 'ðŸ·ï¸ iFLOW CLI Automated Issue Triage'

on:
  issues:
    types:
      - 'opened'
      - 'reopened'
  issue_comment:
    types:
      - 'created'
  workflow_dispatch:
    inputs:
      issue_number:
        description: 'issue number to triage'
        required: true
        type: 'number'

concurrency:
  group: '${{ github.workflow }}-${{ github.event.issue.number }}'
  cancel-in-progress: true

defaults:
  run:
    shell: 'bash'

permissions:
  contents: 'read'
  issues: 'write'
  statuses: 'write'

jobs:
  triage-issue:
    if: |-
      github.event_name == 'issues' ||
      github.event_name == 'workflow_dispatch' ||
      (
        github.event_name == 'issue_comment' &&
        contains(github.event.comment.body, '@iflow-cli /triage') &&
        contains(fromJSON('["OWNER", "MEMBER", "COLLABORATOR"]'), github.event.comment.author_association)
      )
    timeout-minutes: 5
    runs-on: 'ubuntu-latest'
    steps:
      - name: Checkout repository
        uses: actions/checkout@v4

      - name: 'Run iFlow CLI Issue Triage'
        uses: vibe-ideas/iflow-cli-action@main
        id: 'iflow_cli_issue_triage'
        env:
          GITHUB_TOKEN: '${{ secrets.GITHUB_TOKEN }}'
          ISSUE_TITLE: '${{ github.event.issue.title }}'
          ISSUE_BODY: '${{ github.event.issue.body }}'
          ISSUE_NUMBER: '${{ github.event.issue.number }}'
          REPOSITORY: '${{ github.repository }}'
        with:
          api_key: ${{ secrets.IFLOW_API_KEY }}
          timeout: "3600"
          extra_args: "--debug"
          prompt: |
            ## Role

            You are an issue triage assistant. Analyze the current GitHub issue
            and apply the most appropriate existing labels. Use the available
            tools to gather information; do not ask for information to be
            provided.

            ## Steps

            1. Run: `gh label list` to get all available labels.
            2. Review the issue title and body provided in the environment
               variables: "${ISSUE_TITLE}" and "${ISSUE_BODY}".
            3. Classify issues by their kind (bug, enhancement, documentation,
               cleanup, etc) and their priority (p0, p1, p2, p3). Set the
               labels according to the format `kind/*` and `priority/*` patterns.
            4. Apply the selected labels to this issue using:
               `gh issue edit "${ISSUE_NUMBER}" --add-label "label1,label2"`
            5. If the "status/needs-triage" label is present, remove it using:
               `gh issue edit "${ISSUE_NUMBER}" --remove-label "status/needs-triage"`

            ## Guidelines

            - Only use labels that already exist in the repository
            - Do not add comments or modify the issue content
            - Triage only the current issue
            - Assign all applicable labels based on the issue content
            - Reference all shell variables as "${VAR}" (with quotes and braces)

      - name: 'Post Issue Triage Failure Comment'
        if: |-
          ${{ failure() && steps.iflow_cli_issue_triage.outcome == 'failure' }}
        uses: 'actions/github-script@60a0d83039c74a4aee543508d2ffcb1c3799cdea'
        with:
          github-token: '${{ secrets.GITHUB_TOKEN }}'
          script: |-
            github.rest.issues.createComment({
              owner: '${{ github.repository }}'.split('/')[0],
              repo: '${{ github.repository }}'.split('/')[1],
              issue_number: '${{ github.event.issue.number }}',
              body: 'There is a problem with the iFlow CLI issue triaging. Please check the [action logs](${{ github.server_url }}/${{ github.repository }}/actions/runs/${{ github.run_id }}) for details.'
            })
```

å¦‚æžœæ˜¯ä¸€äº›å­˜é‡çš„ issue, å¯ä»¥ç›´æŽ¥åœ¨ issue ä¸­è¯„è®º `@iflow-cli /triage` è§¦å‘è‡ªåŠ¨åˆ†ç±»ã€‚æ•ˆæžœå¦‚ä¸‹, å¯ä»¥çœ‹åˆ° issue è¢« GitHub Actions çš„ robot æœºå™¨äººæ‰“ä¸Šäº†æ ‡ç­¾ [https://github.com/vibe-ideas/iflow-cli-action/issues/14](https://github.com/vibe-ideas/iflow-cli-action/issues/14):

![issue triage](https://gcore.jsdelivr.net/gh/yeshan333/jsDelivrCDN@main/issue-auto-triage.png)

## è®© iFLOW CLI æˆä¸º GitHub issues æ€æ‰‹

å‰æ–‡ä»‹ç»äº† issue çš„è‡ªåŠ¨åˆ†ç±», ä»‹ç»æ¥, æˆ‘ä¼šå°†ä¼šä½¿ç”¨ä¸€ä¸ª GitHub issues æ€æ‰‹, è®© iFLOW CLI å¸®æˆ‘ä»¬å®žçŽ°æŸä¸ªç‰¹æ€§ feature issue æˆ–è€…ä¿®å¤æŸä¸ª bug issueã€‚å·¥ä½œæµå®šä¹‰å¦‚ä¸‹:

{% folding "GitHub Actions å·¥ä½œæµå®šä¹‰" %}

```yaml
name: 'ðŸš€ iFlow CLI Issue Killer'

on:
  issue_comment:
    types:
      - 'created'
  workflow_dispatch:
    inputs:
      issue_number:
        description: 'issue number to implement'
        required: true
        type: 'number'

concurrency:
  group: '${{ github.workflow }}-${{ github.event.issue.number }}'
  cancel-in-progress: true

defaults:
  run:
    shell: 'bash'

permissions:
  contents: 'write'
  issues: 'write'
  pull-requests: 'write'

jobs:
  implement-issue:
    if: |-
      github.event_name == 'workflow_dispatch' ||
      (
        github.event_name == 'issue_comment' &&
        contains(github.event.comment.body, '@iflow-cli /issue-killer') &&
        contains(fromJSON('["OWNER", "MEMBER", "COLLABORATOR"]'), github.event.comment.author_association)
      )
    timeout-minutes: 30
    runs-on: 'ubuntu-latest'
    steps:
      - name: Checkout repository
        uses: actions/checkout@v4
        with:
          token: ${{ secrets.GITHUB_TOKEN }}

      - name: Get Issue Details
        id: get_issue
        uses: 'actions/github-script@60a0d83039c74a4aee543508d2ffcb1c3799cdea'
        with:
          github-token: ${{ secrets.GITHUB_TOKEN }}
          script: |
            const issue_number = process.env.INPUT_ISSUE_NUMBER || context.issue.number;
            core.setOutput('issue_number', issue_number);
            
            const issue = await github.rest.issues.get({
              owner: context.repo.owner,
              repo: context.repo.repo,
              issue_number: parseInt(issue_number)
            });
            
            core.setOutput('issue_title', issue.data.title);
            core.setOutput('issue_body', issue.data.body);
            
            // Parse implementation request from comment or use issue body
            let implementation_request = issue.data.body;
            if (context.eventName === 'issue_comment') {
              implementation_request = context.payload.comment.body.replace('@iflow-cli /issue-killer', '').trim();
              if (implementation_request === '') {
                implementation_request = issue.data.body;
              }
            }
            
            core.setOutput('implementation_request', implementation_request);

      - name: 'Run iFlow CLI Implementation'
        uses: vibe-ideas/iflow-cli-action@main
        id: 'iflow_cli_implementation'
        env:
          GITHUB_TOKEN: '${{ secrets.GITHUB_TOKEN }}'
          ISSUE_TITLE: '${{ steps.get_issue.outputs.issue_title }}'
          ISSUE_BODY: '${{ steps.get_issue.outputs.issue_body }}'
          ISSUE_NUMBER: '${{ steps.get_issue.outputs.issue_number }}'
          REPOSITORY: '${{ github.repository }}'
        with:
          api_key: ${{ secrets.IFLOW_API_KEY }}
          timeout: "1800"
          extra_args: "--debug"
          settings_json: |
            {
                "selectedAuthType": "iflow",
                "apiKey": "${{ secrets.IFLOW_API_KEY }}",
                "baseUrl": "https://apis.iflow.cn/v1",
                "modelName": "Qwen3-Coder",
                "searchApiKey": "${{ secrets.IFLOW_API_KEY }}",
                "mcpServers": {
                  "github": {
                  "command": "github-mcp-server",
                  "args": [
                    "stdio"
                  ],
                  "includeTools": [
                    "create_pull_request",
                    "list_pull_requests",
                    "add_issue_comment"
                  ],
                    "env": {
                      "GITHUB_PERSONAL_ACCESS_TOKEN": "${{ secrets.GITHUB_TOKEN }}"
                    }
                  }
                }
            }
          prompt: |
            ## Role

            You are an implementation assistant. Your task is to implement a feature
            based on the GitHub issue provided. Follow these steps:

            1. **FIRST**: Create a start comment on the issue using the GitHub MCP tool
            2. Analyze the issue title and body provided in the environment
               variables: "${ISSUE_TITLE}" and "${ISSUE_BODY}".
            3. If the comment that triggered this action contains additional
               implementation instructions, use those as well.
            4. Implement the requested feature by creating or modifying files as
               needed.
            5. Ensure all changes are complete and correct according to the issue
               requirements.
            6. Do not add comments or modify the issue content beyond the required start and completion comments.
            7. Focus only on implementing the current issue.

            ## Creating Start Comment

            Before starting the implementation, create a start comment on the issue using the GitHub MCP tool:
            1. Use the add_issue_comment to add a comment to issue #${ISSUE_NUMBER}
            2. The start comment should include:
               - ðŸš€ Notification that the implementation task has started
               - ðŸ¤– Mention that iFlow CLI Issue Killer is processing the issue
               - ðŸ“‹ Current status: analyzing and implementing the feature
               - ðŸ“ **Execution Plan**: Brief outline of the planned implementation steps based on the issue requirements
               - â±ï¸ Expected time: usually takes a few minutes to ten minutes
               - ðŸ” **View execution logs**: [GitHub Actions Run](${{ github.server_url }}/${{ github.repository }}/actions/runs/${{ github.run_id }})
               - ðŸ¤– Note that this is an automated comment and there will be a completion notification
            3. For the execution plan, analyze the issue requirements and provide a clear, numbered list of implementation steps, such as:
               - Files to be created or modified
               - Key functionality to be implemented
               - Tests to be added or updated
               - Dependencies or configurations to be changed

            ## Guidelines

            - Make all necessary code changes to implement the feature
            - Ensure new code follows existing project conventions
            - Add or modify tests if applicable
            - Reference all shell variables as "${VAR}" (with quotes and braces)
            
            ## Creating Pull Request
            
            Once you have implemented the feature, create a pull request using the GitHub MCP tool:
            1. Use the create_pull_request to create a Pull Request.
            2. The PR should be created from a new branch with a descriptive name (e.g., feature/issue-${ISSUE_NUMBER}, fix/issue-${ISSUE_NUMBER}, or a descriptive name based on the feature)
            3. The PR title should be descriptive and reference the issue number
            4. The PR body should explain what was implemented and reference the issue
            5. Remember the branch name you create, as it will be needed for the completion comment if PR creation fails
            
            ## Creating Completion Comment
            
            After successfully implementing the feature and creating the PR, add a completion comment to the issue using the GitHub MCP tool:
            1. Use the add_issue_comment to add a comment to issue #${ISSUE_NUMBER}
            2. The comment should include:
               - âœ… Confirmation that the issue has been implemented
               - ðŸŽ‰ Brief summary of what was accomplished
               - ðŸ“‹ List of key changes made
               - ðŸ”— Link to the created Pull Request (if successful)
               - ðŸ“ If PR creation failed, provide a manual PR creation link using the actual branch name you created, like: https://github.com/${{ github.repository }}/compare/main...[YOUR_BRANCH_NAME]
               - ðŸ¤– Note that this is an automated implementation
            3. Use a friendly tone and include appropriate emojis for better user experience

      - name: 'Post Implementation Failure Comment'
        if: |-
          ${{ failure() && steps.iflow_cli_implementation.outcome == 'failure' }}
        uses: 'actions/github-script@60a0d83039c74a4aee543508d2ffcb1c3799cdea'
        with:
          github-token: '${{ secrets.GITHUB_TOKEN }}'
          script: |-
            github.rest.issues.createComment({
              owner: '${{ github.repository }}'.split('/')[0],
              repo: '${{ github.repository }}'.split('/')[1],
              issue_number: '${{ steps.get_issue.outputs.issue_number }}',
              body: 'There is a problem with the iFlow CLI issue implementation. Please check the [action logs](${{ github.server_url }}/${{ github.repository }}/actions/runs/${{ github.run_id }}) for details.'
            })
```

{% endfolding %}

æˆ‘å°†ä¸Šè¿°å·¥ä½œæµçš„æ‰§è¡Œæœºåˆ¶, è½¬åŒ–ä¸ºäº† mermaid æ—¶åºå›¾, ä¾›å¿«é€Ÿäº†è§£, æ‰§è¡Œæœºåˆ¶å¤§æ¦‚æ˜¯è¿™æ ·çš„ï¼šæˆ‘ä»¬åªéœ€è¦åœ¨ issue ä¸‹è¯„è®º `@iflow-cli /issue-killer` å³å¯è§¦å‘è¿™ä¸ªå·¥ä½œæµã€‚iFLOW CLI ä¼šä½¿ç”¨ [GitHub MCP Server](https://github.com/github/github-mcp-server) å’Œ [gh cli](https://github.com/cli/cli) å‘½ä»¤è¡Œå·¥å…·è‡ªåŠ¨åˆ†æž Issue å†…å®¹å¹¶ç”Ÿæˆæ‰§è¡Œè®¡åˆ’, ç”Ÿæˆä»£ç , ç”Ÿæˆå®ŒæˆåŽä¼šæé†’å¼€å‘è€…å·¥ä½œå·²ç»å®Œæˆã€‚

```mermaid
sequenceDiagram
    participant User as ç”¨æˆ·
    participant GitHub as GitHub
    participant iFlow as iFlow CLI
    participant MCP as GitHub MCP å·¥å…·

    User->>GitHub: åœ¨ Issue ä¸­è¯„è®º @iflow-cli /issue-killer
    GitHub->>iFlow: è§¦å‘å·¥ä½œæµå¹¶ä¼ é€’ Issue ä¿¡æ¯
    iFlow->>MCP: è°ƒç”¨ add_issue_comment æ·»åŠ å¼€å§‹è¯„è®º
    iFlow->>iFlow: åˆ†æž Issue å†…å®¹å¹¶ç”Ÿæˆæ‰§è¡Œè®¡åˆ’
    iFlow->>MCP: ä½¿ç”¨ create_pull_request åˆ›å»º PR
    iFlow->>MCP: è°ƒç”¨ add_issue_comment æ·»åŠ å®Œæˆè¯„è®º
    Note over iFlow,MCP: è‹¥æ‰§è¡Œå¤±è´¥, åˆ™æ·»åŠ å¤±è´¥è¯„è®º
```

å…·ä½“çš„æ•ˆæžœå¯ä»¥æŸ¥çœ‹è¿™ä¸ª iflow-cli-action ä»£ç ä»“åº“çš„è¿™ä¸ª issue, æˆ‘è®© iFLOW CLI åŽ»è‡ªåŠ¨çš„å¸®èŠ±ä¼˜åŒ– iflow-cli-action ä½¿ç”¨çš„é•œåƒä½“ç§¯:

[https://github.com/vibe-ideas/iflow-cli-action/issues/14](https://github.com/vibe-ideas/iflow-cli-action/issues/14)

![issue killer](https://gcore.jsdelivr.net/gh/yeshan333/jsDelivrCDN@main/issue-killer.jpg)

å¯ä»¥çœ‹åˆ° iFLOW CLI ä¼šåœ¨æ‰§è¡Œå‰å¤§æ¦‚å‘ŠçŸ¥æˆ‘ä»¬æ‰§è¡Œè®¡åˆ’, ç„¶åŽæ‰§è¡ŒæˆåŠŸåŽ, ä¼šè‡ªåŠ¨åœ¨ Issue ä¸­è¯„è®ºå¼•å¯¼æˆ‘ä»¬åˆ›å»º Pull Request.

## è®© iFLOW CLI å¯¹ GitHub PR è¿›è¡Œè¯„å®¡

æŽ¥ä¸‹æ¥æˆ‘ä»¬å†çœ‹ä¸€ä¸ªå¸¸è§çš„ä½¿ç”¨åœºæ™¯ï¼šä»£ç è¯„å®¡, è¯ä¸å¤šè¯´, æˆ‘ä»¬ç›´æŽ¥ä¸Š GitHub Actions è‡ªåŠ¨åŒ–å·¥ä½œæµå®šä¹‰, å·¥ä½œæµç¨‹å¦‚ä¸‹ï¼š

```mermaid
sequenceDiagram
    participant User as ç”¨æˆ·
    participant GitHub as GitHub
    participant iFlow as iFlow CLI
    participant MCP as GitHub MCP å·¥å…·

    User->>GitHub: PR ä¸­è¯„è®º @iflow-cli /review
    GitHub->>iFlow: è§¦å‘ PR Review å·¥ä½œæµ
    iFlow->>GitHub: èŽ·å– PR è¯¦ç»†ä¿¡æ¯å’Œå˜æ›´æ–‡ä»¶åˆ—è¡¨
    iFlow->>iFlow: åˆ†æž PR å˜æ›´å†…å®¹ä¸Žä¸Šä¸‹æ–‡
    iFlow->>MCP: åˆ›å»ºå¾…å¤„ç†çš„ PR å®¡æŸ¥
    loop é€æ–‡ä»¶å®¡æŸ¥
        iFlow->>MCP: æ·»åŠ è¡Œå†…è¯„è®ºæˆ–ä»£ç å»ºè®®(å«ä¸¥é‡æ€§æ ‡è¯†)
    end
    iFlow->>MCP: æäº¤ PR å®¡æŸ¥å¹¶é™„ä¸Šæ€»ç»“è¯„è®º
    Note over iFlow,MCP: è‹¥æ‰§è¡Œå¤±è´¥, åˆ™æ·»åŠ å¤±è´¥è¯„è®ºåˆ° PR
```

æ•´ä½“çš„å®žçŽ°æœºåˆ¶ä¸Ž issue-killer å¤§å·®ä¸å·®, åªæ˜¯æ›¿æ¢äº†ä½¿ç”¨åˆ°çš„ MCP å·¥å…·. ç›´æŽ¥åœ¨ PR ä¸­è¯„è®º `@iflow-cli /review` å³å¯è§¦å‘.

ä½ å¯ä»¥åœ¨è¿™ä¸ªä»£ç è¯„å®¡ä¸­çœ‹åˆ°å®žé™…æ•ˆæžœ: [https://github.com/vibe-ideas/iflow-cli-action/pull/15](https://github.com/vibe-ideas/iflow-cli-action/pull/15)

![pr review](https://gcore.jsdelivr.net/gh/yeshan333/jsDelivrCDN@main/pr-review.jpg)

{% folding "GitHub Actions å·¥ä½œæµå®šä¹‰" %}
```yaml
name: 'ðŸ§ iFLOW CLI Pull Request Review'

on:
  pull_request:
    types:
      - 'opened'
      - 'reopened'
  issue_comment:
    types:
      - 'created'
  pull_request_review_comment:
    types:
      - 'created'
  pull_request_review:
    types:
      - 'submitted'
  workflow_dispatch:
    inputs:
      pr_number:
        description: 'PR number to review'
        required: true
        type: 'number'

concurrency:
  group: '${{ github.workflow }}-${{ github.head_ref || github.ref }}'
  cancel-in-progress: true

defaults:
  run:
    shell: 'bash'

permissions:
  contents: 'read'
  issues: 'write'
  pull-requests: 'write'
  statuses: 'write'

jobs:
  review-pr:
    # This condition seeks to ensure the action is only run when it is triggered by a trusted user.
    # For private repos, users who have access to the repo are considered trusted.
    # For public repos, users who members, owners, or collaborators are considered trusted.
    if: |-
      github.event_name == 'workflow_dispatch' ||
      (
        github.event_name == 'pull_request' &&
        (
          github.event.repository.private == true ||
          contains(fromJSON('["OWNER", "MEMBER", "COLLABORATOR"]'), github.event.pull_request.author_association)
        )
      ) ||
      (
        (
          (
            github.event_name == 'issue_comment' &&
            github.event.issue.pull_request
          ) ||
          github.event_name == 'pull_request_review_comment'
        ) &&
        (
          contains(github.event.comment.body, '@iflow-cli /review ') ||
          contains(github.event.comment.body, '@iFlow-CLI /review ') ||
          contains(github.event.comment.body, '@IFLOW-CLI /review ') ||
          contains(github.event.comment.body, '@IFlow-CLI /review ') ||
          endsWith(github.event.comment.body, '@iflow-cli /review') ||
          endsWith(github.event.comment.body, '@iFlow-CLI /review') ||
          endsWith(github.event.comment.body, '@IFLOW-CLI /review') ||
          endsWith(github.event.comment.body, '@IFlow-CLI /review')
        ) &&
        (
          github.event.repository.private == true ||
          contains(fromJSON('["OWNER", "MEMBER", "COLLABORATOR"]'), github.event.comment.author_association)
        )
      ) ||
      (
        github.event_name == 'pull_request_review' &&
        (
          contains(github.event.review.body, '@iflow-cli /review ') ||
          contains(github.event.review.body, '@iFlow-CLI /review ') ||
          contains(github.event.review.body, '@IFLOW-CLI /review ') ||
          contains(github.event.review.body, '@IFlow-CLI /review ') ||
          endsWith(github.event.review.body, '@iflow-cli /review') ||
          endsWith(github.event.review.body, '@iFlow-CLI /review') ||
          endsWith(github.event.review.body, '@IFLOW-CLI /review') ||
          endsWith(github.event.review.body, '@IFlow-CLI /review')
        ) &&
        (
          github.event.repository.private == true ||
          contains(fromJSON('["OWNER", "MEMBER", "COLLABORATOR"]'), github.event.review.author_association)
        )
      )
    timeout-minutes: 5
    runs-on: 'ubuntu-latest'
    steps:
      - name: 'Checkout PR code'
        uses: 'actions/checkout@11bd71901bbe5b1630ceea73d27597364c9af683' # ratchet:actions/checkout@v4

      - name: 'Get PR details (pull_request & workflow_dispatch)'
        id: 'get_pr'
        if: |-
          ${{ github.event_name == 'pull_request' || github.event_name == 'workflow_dispatch' }}
        env:
          GITHUB_TOKEN: '${{ secrets.GITHUB_TOKEN }}'
          EVENT_NAME: '${{ github.event_name }}'
          WORKFLOW_PR_NUMBER: '${{ github.event.inputs.pr_number }}'
          PULL_REQUEST_NUMBER: '${{ github.event.pull_request.number }}'
        run: |-
          set -euo pipefail

          if [[ "${EVENT_NAME}" = "workflow_dispatch" ]]; then
            PR_NUMBER="${WORKFLOW_PR_NUMBER}"
          else
            PR_NUMBER="${PULL_REQUEST_NUMBER}"
          fi

          echo "pr_number=${PR_NUMBER}" >> "${GITHUB_OUTPUT}"

          # Get PR details
          PR_DATA="$(gh pr view "${PR_NUMBER}" --json title,body,additions,deletions,changedFiles,baseRefName,headRefName)"
          echo "pr_data=${PR_DATA}" >> "${GITHUB_OUTPUT}"

          # Get file changes
          CHANGED_FILES="$(gh pr diff "${PR_NUMBER}" --name-only)"
          {
            echo "changed_files<<EOF"
            echo "${CHANGED_FILES}"
            echo "EOF"
          } >> "${GITHUB_OUTPUT}"


      - name: 'Get PR details (issue_comment & reviews)'
        id: 'get_pr_comment'
        if: |-
          ${{ github.event_name == 'issue_comment' || github.event_name == 'pull_request_review' || github.event_name == 'pull_request_review_comment' }}
        env:
          GITHUB_TOKEN: '${{ secrets.GITHUB_TOKEN }}'
          COMMENT_BODY: '${{ github.event.comment.body || github.event.review.body }}'
          PR_NUMBER: '${{ github.event.issue.number || github.event.pull_request.number }}'
        run: |-
          set -euo pipefail

          echo "pr_number=${PR_NUMBER}" >> "${GITHUB_OUTPUT}"

          # Extract additional instructions from comment (case insensitive, exact match for /review)
          ADDITIONAL_INSTRUCTIONS=""
          if echo "${COMMENT_BODY}" | grep -qiE '@iflow-cli[[:space:]]+/review([[:space:]]|$)'; then
            ADDITIONAL_INSTRUCTIONS="$(echo "${COMMENT_BODY}" | sed -E 's/.*@[iI][fF][lL][oO][wW]-[cC][lL][iI][[:space:]]+\/[rR][eE][vV][iI][eE][wW][[:space:]]*(.*)/\1/' | sed 's/^[[:space:]]*//;s/[[:space:]]*$//')"
          fi
          echo "additional_instructions=${ADDITIONAL_INSTRUCTIONS}" >> "${GITHUB_OUTPUT}"

          # Get PR details
          PR_DATA="$(gh pr view "${PR_NUMBER}" --json title,body,additions,deletions,changedFiles,baseRefName,headRefName)"
          echo "pr_data=${PR_DATA}" >> "${GITHUB_OUTPUT}"

          # Get file changes
          CHANGED_FILES="$(gh pr diff "${PR_NUMBER}" --name-only)"
          {
            echo "changed_files<<EOF"
            echo "${CHANGED_FILES}"
            echo "EOF"
          } >> "${GITHUB_OUTPUT}"

      - name: 'Run iFLOW CLI PR Review'
        uses: ./
        id: 'iflow_cli_pr_review'
        env:
          GITHUB_TOKEN: '${{ secrets.GITHUB_TOKEN }}'
          PR_NUMBER: '${{ steps.get_pr.outputs.pr_number || steps.get_pr_comment.outputs.pr_number }}'
          PR_DATA: '${{ steps.get_pr.outputs.pr_data || steps.get_pr_comment.outputs.pr_data }}'
          CHANGED_FILES: '${{ steps.get_pr.outputs.changed_files || steps.get_pr_comment.outputs.changed_files }}'
          ADDITIONAL_INSTRUCTIONS: '${{ steps.get_pr.outputs.additional_instructions || steps.get_pr_comment.outputs.additional_instructions }}'
          REPOSITORY: '${{ github.repository }}'
        with:
          api_key: ${{ secrets.IFLOW_API_KEY }}
          timeout: "3600"
          extra_args: "--debug"
          settings_json: |
            {
                "selectedAuthType": "iflow",
                "apiKey": "${{ secrets.IFLOW_API_KEY }}",
                "baseUrl": "https://apis.iflow.cn/v1",
                "modelName": "Qwen3-Coder",
                "searchApiKey": "${{ secrets.IFLOW_API_KEY }}",
                "mcpServers": {
                  "github": {
                  "command": "github-mcp-server",
                  "args": [
                    "stdio"
                  ],
                  "includeTools": [
                    "create_pending_pull_request_review",
                    "add_comment_to_pending_review",
                    "submit_pending_pull_request_review",
                    "list_pull_requests"
                  ],
                    "env": {
                      "GITHUB_PERSONAL_ACCESS_TOKEN": "${{ secrets.GITHUB_TOKEN }}"
                    }
                  }
                }
            }
          prompt: |
            ## Role

            You are an expert code reviewer. You have access to tools to gather
            PR information and perform the review on GitHub. Use the available tools to
            gather information; do not ask for information to be provided.

            ## Requirements
            1. All feedback must be left on GitHub.
            2. Any output that is not left in GitHub will not be seen.

            ## Steps

            Start by running these commands to gather the required data:
            1. Run: echo "${REPOSITORY}" to get the github repository in <OWNER>/<REPO> format
            2. Run: echo "${PR_DATA}" to get PR details (JSON format)
            3. Run: echo "${CHANGED_FILES}" to get the list of changed files
            4. Run: echo "${PR_NUMBER}" to get the PR number
            5. Run: echo "${ADDITIONAL_INSTRUCTIONS}" to see any specific review
               instructions from the user
            6. Run: gh pr diff "${PR_NUMBER}" to see the full diff and reference
            Context section to understand it
            7. For any specific files, use: cat filename, head -50 filename, or
               tail -50 filename
            8. If ADDITIONAL_INSTRUCTIONS contains text, prioritize those
               specific areas or focus points in your review. Common instruction
               examples: "focus on security", "check performance", "review error
               handling", "check for breaking changes"

            ## Guideline
            ### Core Guideline(Always applicable)

            1. Understand the Context: Analyze the pull request title, description, changes, and code files to grasp the intent.
            2. Meticulous Review: Thoroughly review all relevant code changes, prioritizing added lines. Consider the specified
              focus areas and any provided style guide.
            3. Comprehensive Review: Ensure that the code is thoroughly reviewed, as it's important to the author
              that you identify any and all relevant issues (subject to the review criteria and style guide).
              Missing any issues will lead to a poor code review experience for the author.
            4. Constructive Feedback:
              * Provide clear explanations for each concern.
              * Offer specific, improved code suggestions and suggest alternative approaches, when applicable.
                Code suggestions in particular are very helpful so that the author can directly apply them
                to their code, but they must be accurately anchored to the lines that should be replaced.
            5. Severity Indication: Clearly indicate the severity of the issue in the review comment.
              This is very important to help the author understand the urgency of the issue.
              The severity should be one of the following (which are provided below in decreasing order of severity):
              * `critical`: This issue must be addressed immediately, as it could lead to serious consequences
                for the code's correctness, security, or performance.
              * `high`: This issue should be addressed soon, as it could cause problems in the future.
              * `medium`: This issue should be considered for future improvement, but it's not critical or urgent.
              * `low`: This issue is minor or stylistic, and can be addressed at the author's discretion.
            6. Avoid commenting on hardcoded dates and times being in future or not (for example "this date is in the future").
              * Remember you don't have access to the current date and time and leave that to the author.
            7. Targeted Suggestions: Limit all suggestions to only portions that are modified in the diff hunks.
              This is a strict requirement as the GitHub (and other SCM's) API won't allow comments on parts of code files that are not
              included in the diff hunks.
            8. Code Suggestions in Review Comments:
              * Succinctness: Aim to make code suggestions succinct, unless necessary. Larger code suggestions tend to be
                harder for pull request authors to commit directly in the pull request UI.
              * Valid Formatting:  Provide code suggestions within the suggestion field of the JSON response (as a string literal,
                escaping special characters like \n, \\, \").  Do not include markdown code blocks in the suggestion field.
                Use markdown code blocks in the body of the comment only for broader examples or if a suggestion field would
                create an excessively large diff.  Prefer the suggestion field for specific, targeted code changes.
              * Line Number Accuracy: Code suggestions need to align perfectly with the code it intend to replace.
                Pay special attention to line numbers when creating comments, particularly if there is a code suggestion.
                Note the patch includes code versions with line numbers for the before and after code snippets for each diff, so use these to anchor
                your comments and corresponding code suggestions.
              * Compilable: Code suggestions should be compilable code snippets that can be directly copy/pasted into the code file.
                If the suggestion is not compilable, it will not be accepted by the pull request. Note that not all languages Are
                compiled of course, so by compilable here, we mean either literally or in spirit.
              * Inline Code Comments: Feel free to add brief comments to the code suggestion if it enhances the underlying code readability.
                Just make sure that the inline code comments add value, and are not just restating what the code does. Don't use
                inline comments to "teach" the author (use the review comment body directly for that), instead use it if it's beneficial
                to the readability of the code itself.
            10. Markdown Formatting: Heavily leverage the benefits of markdown for formatting, such as bulleted lists, bold text, tables, etc.
            11. Avoid mistaken review comments:
              * Any comment you make must point towards a discrepancy found in the code and the best practice surfaced in your feedback.
                For example, if you are pointing out that constants need to be named in all caps with underscores,
                ensure that the code selected by the comment does not already do this, otherwise it's confusing let alone unnecessary.
            12. Remove Duplicated code suggestions:
              * Some provided code suggestions are duplicated, please remove the duplicated review comments.
            13. Don't Approve The Pull Request
            14. Reference all shell variables as "${VAR}" (with quotes and braces)

            ### Review Criteria (Prioritized in Review)

            * Correctness: Verify code functionality, handle edge cases, and ensure alignment between function
              descriptions and implementations.  Consider common correctness issues (logic errors, error handling,
              race conditions, data validation, API usage, type mismatches).
            * Efficiency: Identify performance bottlenecks, optimize for efficiency, and avoid unnecessary
              loops, iterations, or calculations. Consider common efficiency issues (excessive loops, memory
              leaks, inefficient data structures, redundant calculations, excessive logging, etc.).
            * Maintainability: Assess code readability, modularity, and adherence to language idioms and
              best practices. Consider common maintainability issues (naming, comments/documentation, complexity,
              code duplication, formatting, magic numbers).  State the style guide being followed (defaulting to
              commonly used guides, for example Python's PEP 8 style guide or Google Java Style Guide, if no style guide is specified).
            * Security: Identify potential vulnerabilities (e.g., insecure storage, injection attacks,
              insufficient access controls).

            ### Miscellaneous Considerations
            * Testing: Ensure adequate unit tests, integration tests, and end-to-end tests. Evaluate
              coverage, edge case handling, and overall test quality.
            * Performance: Assess performance under expected load, identify bottlenecks, and suggest
              optimizations.
            * Scalability: Evaluate how the code will scale with growing user base or data volume.
            * Modularity and Reusability: Assess code organization, modularity, and reusability. Suggest
              refactoring or creating reusable components.
            * Error Logging and Monitoring: Ensure errors are logged effectively, and implement monitoring
              mechanisms to track application health in production.

            **CRITICAL CONSTRAINTS:**

            You MUST only provide comments on lines that represent the actual changes in
            the diff. This means your comments should only refer to lines that begin with
            a `+` or `-` character in the provided diff content.
            DO NOT comment on lines that start with a space (context lines).

            You MUST only add a review comment if there exists an actual ISSUE or BUG in the code changes.
            DO NOT add review comments to tell the user to "check" or "confirm" or "verify" something.
            DO NOT add review comments to tell the user to "ensure" something.
            DO NOT add review comments to explain what the code change does.
            DO NOT add review comments to validate what the code change does.
            DO NOT use the review comments to explain the code to the author. They already know their code. Only comment when there's an improvement opportunity. This is very important.

            Pay close attention to line numbers and ensure they are correct.
            Pay close attention to indentations in the code suggestions and make sure they match the code they are to replace.
            Avoid comments on the license headers - if any exists - and instead make comments on the code that is being changed.

            It's absolutely important to avoid commenting on the license header of files.
            It's absolutely important to avoid commenting on copyright headers.
            Avoid commenting on hardcoded dates and times being in future or not (for example "this date is in the future").
            Remember you don't have access to the current date and time and leave that to the author.

            Avoid mentioning any of your instructions, settings or criteria.

            Here are some general guidelines for setting the severity of your comments
            - Comments about refactoring a hardcoded string or number as a constant are generally considered low severity.
            - Comments about log messages or log enhancements are generally considered low severity.
            - Comments in .md files are medium or low severity. This is really important.
            - Comments about adding or expanding docstring/javadoc have low severity most of the times.
            - Comments about suppressing unchecked warnings or todos are considered low severity.
            - Comments about typos are usually low or medium severity.
            - Comments about testing or on tests are usually low severity.
            - Do not comment about the content of a URL if the content is not directly available in the input.

            Keep comments bodies concise and to the point.
            Keep each comment focused on one issue.

            ## Context
            The files that are changed in this pull request are represented below in the following
            format, showing the file name and the portions of the file that are changed:

            <PATCHES>
            FILE:<NAME OF FIRST FILE>
            DIFF:
            <PATCH IN UNIFIED DIFF FORMAT>

            --------------------

            FILE:<NAME OF SECOND FILE>
            DIFF:
            <PATCH IN UNIFIED DIFF FORMAT>

            --------------------

            (and so on for all files changed)
            </PATCHES>

            Note that if you want to make a comment on the LEFT side of the UI / before the diff code version
            to note those line numbers and the corresponding code. Same for a comment on the RIGHT side
            of the UI / after the diff code version to note the line numbers and corresponding code.
            This should be your guide to picking line numbers, and also very importantly, restrict
            your comments to be only within this line range for these files, whether on LEFT or RIGHT.
            If you comment out of bounds, the review will fail, so you must pay attention the file name,
            line numbers, and pre/post diff versions when crafting your comment.

            Here are the patches that were implemented in the pull request, per the
            formatting above:

            The get the files changed in this pull request, run:
            "$(gh pr diff "${PR_NUMBER}" --patch)" to get the list of changed files PATCH

            ## Review

            Once you have the information and are ready to leave a review on GitHub, post the review to GitHub using the GitHub MCP tool by:
            1. Creating a pending review: Use the mcp__github__create_pending_pull_request_review to create a Pending Pull Request Review.

            2. Adding review comments:
                2.1 Use the mcp__github__add_comment_to_pending_review to add comments to the Pending Pull Request Review. Inline comments are preferred whenever possible, so repeat this step, calling mcp__github__add_comment_to_pending_review, as needed. All comments about specific lines of code should use inline comments. It is preferred to use code suggestions when possible, which include a code block that is labeled "suggestion", which contains what the new code should be. All comments should also have a severity. The syntax is:
                  Normal Comment Syntax:
                  <COMMENT>
                  {{SEVERITY}} {{COMMENT_TEXT}}
                  </COMMENT>

                  Inline Comment Syntax: (Preferred):
                  <COMMENT>
                  {{SEVERITY}} {{COMMENT_TEXT}}
                  ```suggestion
                  {{CODE_SUGGESTION}}
                  ```
                  </COMMENT>

                  Prepend a severity emoji to each comment:
                  - ðŸŸ¢ for low severity
                  - ðŸŸ¡ for medium severity
                  - ðŸŸ  for high severity
                  - ðŸ”´ for critical severity
                  - ðŸ”µ if severity is unclear

                  Including all of this, an example inline comment would be:
                  <COMMENT>
                  ðŸŸ¢ Use camelCase for function names
                  ```suggestion
                  myFooBarFunction
                  ```
                  </COMMENT>

                  A critical severity example would be:
                  <COMMENT>
                  ðŸ”´ Remove storage key from GitHub
                  ```suggestion
                  ```

            3. Posting the review: Use the mcp__github__submit_pending_pull_request_review to submit the Pending Pull Request Review.

              3.1 Crafting the summary comment: Include a summary of high level points that were not addressed with inline comments. Be concise. Do not repeat details mentioned inline.

                Structure your summary comment using this exact format with markdown:
                ## ðŸ“‹ Review Summary

                Provide a brief 2-3 sentence overview of the PR and overall
                assessment.

                ## ðŸ” General Feedback
                - List general observations about code quality
                - Mention overall patterns or architectural decisions
                - Highlight positive aspects of the implementation
                - Note any recurring themes across files

            ## Final Instructions

            Remember, you are running in a VM and no one reviewing your output. Your review must be posted to GitHub using the MCP tools to create a pending review, add comments to the pending review, and submit the pending review.


      - name: 'Post PR review failure comment'
        if: |-
          ${{ failure() && steps.iflow_cli_pr_review.outcome == 'failure' }}
        uses: 'actions/github-script@60a0d83039c74a4aee543508d2ffcb1c3799cdea'
        with:
          github-token: '${{ secrets.GITHUB_TOKEN }}'
          script: |-
            github.rest.issues.createComment({
              owner: '${{ github.repository }}'.split('/')[0],
              repo: '${{ github.repository }}'.split('/')[1],
              issue_number: '${{ steps.get_pr.outputs.pr_number || steps.get_pr_comment.outputs.pr_number }}',
              body: 'There is a problem with the iFLOW CLI PR review. Please check the [action logs](${{ github.server_url }}/${{ github.repository }}/actions/runs/${{ github.run_id }}) for details.'
            })
```
{% endfolding %}

## ç»“è¯­

iFLOW CLI ç›®å‰çš„ Agent èƒ½åŠ›ç®—æ˜¯ä¸é”™çš„äº†, ä½ å¯ä»¥éšæ„ä¿®æ”¹ä¸Šè¿°å·¥ä½œæµä¸­çš„ prompt, è®©å®ƒæ›´è´´åˆä½ çš„ä½¿ç”¨åœºæ™¯ã€‚ç¥ä½ çŽ©å¾—å¼€å¿ƒ(*^â–½^*)~.
